<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.13"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>Counters and Ultrasonic Sensors: Main Page</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript">
  $(document).ready(initResizable);
</script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">Counters and Ultrasonic Sensors
   &#160;<span id="projectnumber">Lab06</span>
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.13 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
$(document).ready(function(){initNavTree('index.html','');});
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="headertitle">
<div class="title">Counters and Ultrasonic Sensors Documentation</div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><h1><a class="anchor" id="Introduction"></a>
Introduction</h1>
<p>This will serve as documentation for lab 6 for the CENG447: Embedded systems classes for the Spring of 2019.</p>
<p>Lab 6's goal was use Timer1 to count the duration of the pulse width of the echo pulse on the ultrasonic sensor and to generate an accurate 10ms trigger signal. As always the source code can be found <a href="https://github.com/warlock31415/Embedded-CENG447/tree/master/Lab06">here</a></p>
<p>A clk/8 prescaler was used to get a tick every 0.5ms. This meant that in order to generate a 10ms pulse we'd have to count 20 ticks. To count the pulse width of the return pulse, a pin change interrupt was used. The pin change interrupt triggers on both falling and rising edges so accurate track must be kept of which event caused interrupt. A flag was used to do this. On a rising edge, the flag is set to 1 and TCNT1 is set to 0. On a falling edge, the flag is cleared and the vlaue in TCNT1 is read.</p>
<p>While this is happening, The program first waits for the ECHO pin to read high and then waits for the pin to go low again (The interrupt occures during this wait). It then returns the value that was read from TCNT1 and divides it by 116.</p>
<p>The division factor was obtained from the datasheet of the sensor. But since every tick is 0.5ms we must first divide it by 2 to get the time elapse in ms and then divide it by 58 (datasheet value) to get the distance.</p>
<h1><a class="anchor" id="Video"></a>
Video</h1>
<p>The robot can be seen measuring distances <a href="https://photos.app.goo.gl/2ECBMUaLxQM8WiUg8">here</a></p>
<p>The robot can be seen keep it's distance from the wall <a href="https://photos.app.goo.gl/sDKsXncgCjGFD5kz8">here</a> </p>
<h1><a class="anchor" id="Document"></a>
Document</h1>
<p>Download the PDF by clicking <a href="./Lab_6.pdf">here</a></p>
<h1><a class="anchor" id="Issues"></a>
Issues</h1>
<ol type="1">
<li>Broken US<ul>
<li>The initial ultrasonic sensor was broken and had to replaced. </li>
</ul>
</li>
</ol>
</div></div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="footer">Generated by
    <a href="http://www.doxygen.org/index.html">
    <img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.8.13 </li>
  </ul>
</div>
</body>
</html>
